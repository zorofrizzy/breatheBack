<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReportForm Component Test</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .test-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #4A5568;
        }
        .test-result {
            padding: 10px;
            margin-top: 10px;
            border-radius: 8px;
            font-size: 14px;
        }
        .test-result.success {
            background: #D4F1E8;
            color: #6BC4A6;
        }
        .test-result.error {
            background: #FFE5A3;
            color: #4A5568;
        }
    </style>
</head>
<body>
    <h1>ReportForm Component Test</h1>
    
    <div class="test-section">
        <div class="test-title">Test 1: Component Initialization</div>
        <div id="test-1-result" class="test-result"></div>
    </div>
    
    <div class="test-section">
        <div class="test-title">Test 2: Type Selection Required</div>
        <p style="font-size: 14px; color: #718096; margin-bottom: 10px;">
            Submit button should be disabled until type is selected
        </p>
        <div id="test-2-result" class="test-result"></div>
    </div>
    
    <div class="test-section">
        <div class="test-title">Test 3: ReportForm Component</div>
        <div id="report-form-container"></div>
        <div id="restoration-card-container"></div>
    </div>
    
    <div class="test-section">
        <div class="test-title">Test 4: Form State</div>
        <button id="check-state-button" style="padding: 10px 20px; background: #6BC4A6; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Check Form State
        </button>
        <div id="test-4-result" class="test-result" style="display: none;"></div>
    </div>
    
    <script src="reportForm.js"></script>
    <script>
        // Test 1: Component Initialization
        function test1() {
            const result = document.getElementById('test-1-result');
            try {
                if (typeof ReportForm === 'function') {
                    result.textContent = '✓ ReportForm class is defined';
                    result.className = 'test-result success';
                } else {
                    result.textContent = '✗ ReportForm class is not defined';
                    result.className = 'test-result error';
                }
            } catch (error) {
                result.textContent = '✗ Error: ' + error.message;
                result.className = 'test-result error';
            }
        }
        
        // Test 2: Type Selection Required
        function test2() {
            const result = document.getElementById('test-2-result');
            try {
                const submitButton = document.getElementById('submit-report-button');
                if (submitButton && submitButton.disabled) {
                    result.textContent = '✓ Submit button is disabled by default';
                    result.className = 'test-result success';
                } else {
                    result.textContent = '✗ Submit button should be disabled by default';
                    result.className = 'test-result error';
                }
            } catch (error) {
                result.textContent = '✗ Error: ' + error.message;
                result.className = 'test-result error';
            }
        }
        
        // Initialize ReportForm
        let reportForm = null;
        
        function initializeReportForm() {
            reportForm = new ReportForm({
                containerId: 'report-form-container',
                onSubmit: (data) => {
                    console.log('Report submitted:', data);
                    
                    // Show restoration action card
                    const restorationCardContainer = document.getElementById('restoration-card-container');
                    if (restorationCardContainer) {
                        restorationCardContainer.innerHTML = `
                            <div class="restoration-card">
                                <div class="restoration-card-header">
                                    <h2 class="restoration-card-title">Help Restore the Air</h2>
                                    <p class="restoration-card-subtitle">Choose an action to complete</p>
                                </div>
                                <div class="action-list">
                                    ${data.suggestions.map(action => `
                                        <div class="action-item">
                                            <div class="action-content">
                                                <div class="action-title">${action.title}</div>
                                                <div class="action-description">${action.description}</div>
                                            </div>
                                            <div class="action-points">+${action.points}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    }
                },
                onLocationError: (message) => {
                    console.error('Location error:', message);
                }
            });
            
            reportForm.init();
            
            // Run tests after initialization
            setTimeout(() => {
                test1();
                test2();
            }, 100);
        }
        
        // Test 4: Check Form State
        document.getElementById('check-state-button').addEventListener('click', () => {
            const result = document.getElementById('test-4-result');
            result.style.display = 'block';
            
            if (reportForm) {
                const state = reportForm.getState();
                result.innerHTML = `
                    <strong>Form State:</strong><br>
                    Selected Type: ${state.selectedType || 'None'}<br>
                    Selected Context: ${state.selectedContext || 'None'}<br>
                    Location Permission: ${state.locationPermissionGranted ? 'Granted' : 'Not Granted'}<br>
                    Current Location: ${state.currentLocation ? 'Available' : 'Not Available'}
                `;
                result.className = 'test-result success';
            } else {
                result.textContent = '✗ ReportForm not initialized';
                result.className = 'test-result error';
            }
        });
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', initializeReportForm);
    </script>
</body>
</html>
