<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NavigationBar Component Test</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .test-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #4A5568;
        }
        
        .test-result {
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .test-result.pass {
            background: #D4F1E8;
            color: #6BC4A6;
        }
        
        .test-result.fail {
            background: #FFE5E5;
            color: #E53E3E;
        }
        
        .view-indicator {
            padding: 20px;
            background: #E8F4F8;
            border-radius: 12px;
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            color: #5A9FBE;
            margin-bottom: 20px;
        }
        
        #app {
            padding-bottom: 100px;
        }
    </style>
</head>
<body>
    <div id="app">
        <h1 style="text-align: center; margin-bottom: 30px;">NavigationBar Component Test</h1>
        
        <div class="view-indicator" id="current-view-display">
            Current View: <span id="view-name">report</span>
        </div>
        
        <div class="test-section">
            <div class="test-title">Test 1: NavigationBar Initialization</div>
            <div>Checks if NavigationBar component initializes correctly</div>
            <div class="test-result" id="test-1-result">Running...</div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Test 2: Four Navigation Items</div>
            <div>Verifies that exactly 4 navigation items are rendered</div>
            <div class="test-result" id="test-2-result">Running...</div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Test 3: Active View Highlighting</div>
            <div>Checks if the current view is highlighted correctly</div>
            <div class="test-result" id="test-3-result">Running...</div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Test 4: View Change Handler</div>
            <div>Tests if clicking navigation items triggers view changes</div>
            <div class="test-result" id="test-4-result">Running...</div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Test 5: Maximum Navigation Distance</div>
            <div>Verifies that any view can be reached in at most 2 taps (actually 1 tap with bottom nav)</div>
            <div class="test-result" id="test-5-result">Running...</div>
        </div>
        
        <!-- Navigation Bar -->
        <nav id="navigation-bar" class="nav-bar"></nav>
    </div>
    
    <script src="navigation.js"></script>
    <script>
        // Test suite for NavigationBar component
        let testResults = {
            passed: 0,
            failed: 0
        };
        
        let currentView = 'report';
        let viewChangeCount = 0;
        
        function updateViewDisplay(view) {
            document.getElementById('view-name').textContent = view;
            currentView = view;
            viewChangeCount++;
        }
        
        function showTestResult(testId, passed, message) {
            const resultElement = document.getElementById(`test-${testId}-result`);
            resultElement.className = `test-result ${passed ? 'pass' : 'fail'}`;
            resultElement.textContent = passed ? `✓ PASS: ${message}` : `✗ FAIL: ${message}`;
            
            if (passed) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }
        }
        
        // Initialize NavigationBar
        const navigationBar = new NavigationBar({
            containerId: 'navigation-bar',
            currentView: 'report',
            onViewChange: (view) => {
                console.log('View changed to:', view);
                updateViewDisplay(view);
            }
        });
        
        // Run tests
        function runTests() {
            // Test 1: Initialization
            try {
                navigationBar.init();
                const container = document.getElementById('navigation-bar');
                const hasContent = container && container.children.length > 0;
                showTestResult(1, hasContent, 'NavigationBar initialized with content');
            } catch (error) {
                showTestResult(1, false, `Initialization error: ${error.message}`);
            }
            
            // Test 2: Four navigation items
            setTimeout(() => {
                const navItems = document.querySelectorAll('.nav-item');
                const hasFourItems = navItems.length === 4;
                showTestResult(2, hasFourItems, `Found ${navItems.length} navigation items (expected 4)`);
            }, 100);
            
            // Test 3: Active view highlighting
            setTimeout(() => {
                const activeItems = document.querySelectorAll('.nav-item.active');
                const hasOneActive = activeItems.length === 1;
                const correctActive = activeItems[0]?.getAttribute('data-view') === 'report';
                const passed = hasOneActive && correctActive;
                showTestResult(3, passed, passed ? 'Report view is highlighted' : 'Active highlighting incorrect');
            }, 200);
            
            // Test 4: View change handler
            setTimeout(() => {
                const heatmapButton = document.querySelector('.nav-item[data-view="heatmap"]');
                if (heatmapButton) {
                    heatmapButton.click();
                    
                    setTimeout(() => {
                        const viewChanged = currentView === 'heatmap';
                        const activeItems = document.querySelectorAll('.nav-item.active');
                        const correctHighlight = activeItems[0]?.getAttribute('data-view') === 'heatmap';
                        const passed = viewChanged && correctHighlight;
                        showTestResult(4, passed, passed ? 'View changed to heatmap and highlighted' : 'View change failed');
                    }, 100);
                } else {
                    showTestResult(4, false, 'Heatmap button not found');
                }
            }, 300);
            
            // Test 5: Maximum navigation distance (1 tap with bottom nav)
            setTimeout(() => {
                // From heatmap, click community (1 tap)
                const communityButton = document.querySelector('.nav-item[data-view="community"]');
                if (communityButton) {
                    communityButton.click();
                    
                    setTimeout(() => {
                        const viewChanged = currentView === 'community';
                        // Any view can be reached in 1 tap from any other view with bottom navigation
                        showTestResult(5, viewChanged, 'Any view reachable in 1 tap (bottom nav design)');
                        
                        // Show final results
                        setTimeout(() => {
                            console.log('Test Results:', testResults);
                            alert(`Tests Complete!\nPassed: ${testResults.passed}\nFailed: ${testResults.failed}`);
                        }, 100);
                    }, 100);
                } else {
                    showTestResult(5, false, 'Community button not found');
                }
            }, 600);
        }
        
        // Run tests when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', runTests);
        } else {
            runTests();
        }
    </script>
</body>
</html>
